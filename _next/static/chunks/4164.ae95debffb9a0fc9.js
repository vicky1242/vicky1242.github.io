!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cbfb0e73-0e1e-4cc1-9388-25a177ab25c3",e._sentryDebugIdIdentifier="sentry-dbid-cbfb0e73-0e1e-4cc1-9388-25a177ab25c3")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4164],{94164:function(e,t,a){a.r(t),a.d(t,{VaultContext:function(){return E},VaultProvider:function(){return R}});var r=a(82323),i=a(32099),n=a(97458),o=a(73187),c=a(27306),s=a(52983),u=a(439),l=a(52654),d=a(28110),f=a(13430),w=a(70117),v=a(69844),m=a(78825),_=a(47118),C=a(23183),h=a(82998),b=a(75663),y=a(17239);let g={abi:(0,w.V)(u.MI),address:u.b0,chainId:1},p={abi:(0,w.V)(u.GU),address:u.N3,chainId:1},E=(0,s.createContext)({approved:!1,claimableSvXai:void 0,claimSvXai:()=>Promise.resolve("0x"),depositXai:()=>Promise.resolve("0x"),getMaxClaimableXai:()=>Promise.resolve(null),isWrongNetwork:!1,refetch:()=>Promise.resolve(),maxClaimableXai:void 0,requestApproveLimit:()=>Promise.resolve("0x"),svXaiBalance:void 0,vaultBalance:void 0,walletXaiBalance:void 0,withdrawXai:()=>Promise.resolve("0x"),xaiBalance:void 0,updateApprovedStatus:()=>Promise.resolve()}),R=e=>{let{children:t}=e,{data:a}=(0,h.p)(),w=(0,b.t)({chainId:C.R.id}),{address:R,chain:N}=(0,y.m)(),[x,S]=(0,s.useState)(void 0),[I,X]=(0,s.useState)(void 0),[k,P]=(0,s.useState)(void 0),[V,O]=(0,s.useState)(void 0),[A,Z]=(0,s.useState)(void 0),[D,B]=(0,s.useState)(null),[M,U]=(0,s.useState)(void 0),[W,j]=(0,s.useState)(!1),{stakingMigrateMerkleProof:q,stakingMigrateXai:G}=(0,l.k)(),L=async()=>{if(w&&R){if(!q){P("0");return}if(await w.readContract((0,i._)((0,r._)({},g),{functionName:"merkleClaimed",args:[R]})))P("0");else{let e=(0,v.v)(G||"0",o.C9);P((0,m.d)(e))}}},z=async()=>{if(!w||!R)return null;let e=await w.readContract((0,i._)((0,r._)({},g),{functionName:"maxWithdraw",args:[R]}));return(0,f.C4)(e)?(0,m.d)(e):null},F=async()=>{if(!w)return;let e=await w.readContract((0,i._)((0,r._)({},g),{functionName:"totalAssets"}));if(!(0,f.C4)(e)||(S((0,m.d)(e)),!R))return;let t=await w.readContract((0,i._)((0,r._)({},g),{functionName:"balanceOf",args:[R]}));if(!(0,f.C4)(t))return;X((0,m.d)(t)),await L();let a=await z();a&&U(a)},H=async()=>{if(!I||!k){O("0");return}if(!w)return;let e=(0,o.n)(I).plus(k).toString(),t=await w.readContract((0,i._)((0,r._)({},g),{functionName:"previewRedeem",args:[(0,_.f)(e)]}));if(!(0,f.C4)(t))return;let a=(0,m.d)(t);if(!a){O("0");return}O(a)},J=async()=>{if(!w||!R)return;let e=await w.readContract((0,i._)((0,r._)({},p),{functionName:"balanceOf",args:[R]}));(0,f.C4)(e)&&Z((0,m.d)(e))},K=async()=>{if(!w||!R)return;let e=await w.readContract((0,i._)((0,r._)({},p),{functionName:"allowance",args:[R,u.b0]}));(0,f.C4)(e)&&B(e>=(0,_.f)(u.ND))},Q=async e=>{if(!w||!R)return;let t=await w.readContract((0,i._)((0,r._)({},p),{functionName:"allowance",args:[R,u.b0]}));(0,f.C4)(t)&&B(t>=(0,_.f)(e))},T=async()=>{if(!(null==a?void 0:a.account))throw Error("writeXaiContract is missing");return await a.writeContract((0,i._)((0,r._)({},p),{functionName:"approve",args:[u.b0,u.Uf]}))},Y=async e=>{if(!(null==a?void 0:a.account))throw Error("writeVault is missing");return await a.writeContract((0,i._)((0,r._)({},g),{functionName:"deposit",args:[(0,_.f)(e),R]}))},$=async e=>{if(!(null==a?void 0:a.account))throw Error("writeVault is missing");return await a.writeContract((0,i._)((0,r._)({},g),{functionName:"withdraw",args:[(0,_.f)(e),R,R]}))},ee=async()=>{if(!(null==a?void 0:a.account))throw Error("writeVault is missing");if(!q)throw Error("Can't claim svXAI without merkle proof");if(!k)throw Error("No svXAI to claim");return await a.writeContract((0,i._)((0,r._)({},g),{functionName:"claimShares",args:[R,(0,_.f)(k),q]}))},et=()=>{(null==N?void 0:N.id)===c.Ay.ethereum.id?j(!1):j(!0)},ea=()=>{S(void 0),X(void 0),P(void 0),U(void 0),O(void 0),Z(void 0),B(null)},er=async()=>{ea(),await H(),await F(),await J(),await K()};(0,s.useEffect)(()=>{et()},[N]),(0,s.useEffect)(()=>{w&&(F().catch(e=>(0,d.Z)([e],d._.ERROR)),J().catch(e=>(0,d.Z)([e],d._.ERROR)))},[w]),(0,s.useEffect)(()=>{I&&ee&&H().catch(e=>(0,d.Z)([e],d._.ERROR))},[I,k]),(0,s.useEffect)(()=>{(null==a?void 0:a.account)&&(J().catch(e=>(0,d.Z)([e],d._.ERROR)),K().catch(e=>(0,d.Z)([e],d._.ERROR)))},[null==a?void 0:a.account]),(0,s.useEffect)(()=>{er().catch(e=>(0,d.Z)([e],d._.ERROR))},[R]);let ei=(0,s.useMemo)(()=>({approved:D,claimableSvXai:k,claimSvXai:ee,depositXai:Y,getMaxClaimableXai:z,isWrongNetwork:W,refetch:er,maxClaimableXai:M,requestApproveLimit:T,svXaiBalance:I,vaultBalance:x,walletXaiBalance:A,withdrawXai:$,xaiBalance:V,updateApprovedStatus:Q}),[D,k,ee,Y,z,W,er,M,I,x,A,$,V]);return(0,n.jsx)(E.Provider,{value:ei,"data-sentry-element":"unknown","data-sentry-component":"VaultProvider","data-sentry-source-file":"VaultContext.tsx",children:t})}}}]);