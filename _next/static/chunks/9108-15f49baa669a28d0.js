!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e5a53533-ef5b-4a5e-984d-fdeb6475978c",e._sentryDebugIdIdentifier="sentry-dbid-e5a53533-ef5b-4a5e-984d-fdeb6475978c")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9108],{79108:function(e,t,s){s.d(t,{J:function(){return V}});var r,n=s(97458),a=s(73187),i=s(31585),o=s(74017),l=s(93295),d=s(69800),c=s.n(d),m=s(52983),f=s(41599),u=s(82323),h=s(23236),x=s(15308),y=s(99840),p=s(89880),w=s(72971),g=s(11681),S=s(63412),b=s(47331),j=s(87066);let I=e=>e.reduce((e,t)=>{let s=!(t.deposits||[]).length,r=t.expiresAtISO&&new Date(t.expiresAtISO)<new Date;return s?e.push({orderId:t.id,createdAtISO:t.createdAtISO,expiresAtISO:t.expiresAtISO,depositMethodId:t.depositMethod.id,settleMethodId:t.settleMethod.id,status:r?"expired":"pending"}):e.push((0,u._)({orderId:t.id,expiresAtISO:t.expiresAtISO,depositMethodId:t.depositMethod.id,settleMethodId:t.settleMethod.id,settleAmountUsd:(0,j.Zd)(t.deposits).depositAmountUsd},(0,j.Zd)(t.deposits))),e},[]),k={currentPage:1,goToPage:()=>null,refetchShiftHistory:()=>null,pageSize:10,shifts:[],selectedDateRange:{from:(0,x.Z)()||b.z3?new Date(2022,3,11):new Date(Date.now()-2592e6),to:(0,x.Z)()||b.z3?new Date(2022,4,11):new Date},updateSelectedDateRange:()=>{},getFormattedShiftsForExport:async()=>[]},v=(0,m.createContext)(k),H=e=>{let{children:t,initialShiftsData:s,shouldUseSearchParams:r=!0}=e,[a,i]=(0,m.useState)((null==s?void 0:s.edges)||[]),[o,l]=(0,m.useState)(0),d=(0,w.l)(),c=(0,p.useRouter)(),f=d.get(S.I4.FROM_DATE),u=d.get(S.I4.TO_DATE),j=d.get(S.I4.PAGE),H=()=>c.push("".concat(c.pathname,"?").concat(d.toString()),void 0,{shallow:!0}),[D,T]=(0,m.useState)(f&&u?{from:new Date(+f),to:new Date(+u)}:k.selectedDateRange),[A,N]=(0,m.useState)(+(j||1)),O=e=>{N(e),r&&(d.set(S.I4.PAGE,e.toString()),H())},{loading:C,error:M,stopPolling:E,refetch:_,client:P}=(0,h.a)(g.Hh,{pollInterval:0,variables:{fromDate:D.from&&(0,y.Z)(D.from,"yyyy-MM-dd"),toDate:D.to&&(0,y.Z)(D.to,"yyyy-MM-dd"),limit:10,offset:(A-1)*10},skip:!D.from||!D.to,onCompleted:e=>{e&&D.from&&D.to&&(i(e.session.ordersNext.edges),l(e.session.ordersNext.totalCount))}});((0,x.Z)()||b.z3)&&E();let R=e=>{T(e),e.from&&e.to&&r&&(d.set(S.I4.FROM_DATE,e.from.valueOf().toString()),d.set(S.I4.TO_DATE,e.to.valueOf().toString()),d.set(S.I4.PAGE,"1"),N(1),H())};(0,m.useEffect)(()=>{if(j&&j!==A.toString()&&N(parseInt(j)),f&&u&&D.to&&D.from){let e={from:new Date(+f),to:new Date(+u)};(D.to.getTime()!==e.to.getTime()||D.from.getTime()!==e.from.getTime())&&T(e)}},[d]),(0,m.useEffect)(()=>{r&&!f&&!u&&!j&&D.from&&D.to&&d.has(S.I4.FROM_DATE)&&d.has(S.I4.TO_DATE)&&d.has(S.I4.PAGE)&&(d.set(S.I4.FROM_DATE,D.from.valueOf().toString()),d.set(S.I4.TO_DATE,D.to.valueOf().toString()),d.set(S.I4.PAGE,A.toString()),H())},[r,A,D.from,D.to]);let Z=async()=>{if(!D.from||!D.to||!o)return[];try{let{data:e}=await P.query({query:g.Hh,variables:{fromDate:(0,y.Z)(D.from,"yyyy-MM-dd"),toDate:(0,y.Z)(D.to,"yyyy-MM-dd"),limit:o,offset:0},fetchPolicy:"network-only"});return I(e.session.ordersNext.edges)}catch(e){return console.error("Error fetching all shifts for export:",e),[]}},z=(0,m.useMemo)(()=>({shifts:a,error:M,isLoading:C,refetchShiftHistory:_,currentPage:A,goToPage:O,pageSize:10,totalCount:o,updateSelectedDateRange:R,selectedDateRange:D,getFormattedShiftsForExport:Z}),[a,D,A,C,o]);return(0,n.jsx)(v.Provider,{value:z,"data-sentry-element":"unknown","data-sentry-component":"ShiftsHistoryProvider","data-sentry-source-file":"ShiftsHistoryContext.tsx",children:t})};var D=s(54193),T=s(52654);let A=()=>(0,m.useContext)(v);var N=s(84734),O=s(27306),C=s(81308),M=s(85266),E=s(42138),_=s(80833);function P(){return(P=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}var R=e=>m.createElement("svg",P({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 19 58"},e),r||(r=m.createElement("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:6,d:"m3.2 3.647 10.312 17.367a16 16 0 0 1-.057 16.433l-10.255 17"}))),Z=s(39989),z=s(63686),F=s(32019),U=s(70139),G=s(5034),W=s(7969),B=s(56001);function K(e,t){return(null==e?void 0:e.status)||(t?"expired":"pending")}let L=()=>(0,n.jsx)(M.i.Head,{"data-sentry-element":"unknown","data-sentry-component":"TableHead","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:(0,n.jsxs)(M.i.Row,{className:"hidden md:grid md:grid-cols-[13rem_minmax(0,3fr)_minmax(0,3fr)_10rem_2rem]","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[(0,n.jsx)(M.i.Heading,{"data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:"Created At"}),(0,n.jsx)(M.i.Heading,{className:"w-1/4 md:w-1/5","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:"From"}),(0,n.jsx)(M.i.Heading,{className:"w-1/4 md:w-1/5","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:"To"}),(0,n.jsx)(M.i.Heading,{className:"w-[15%] md:w-1/4","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:"Status"})]})}),X=e=>{let{order:t,onClick:s}=e,r=new Date(t.createdAtISO),a=r.toLocaleTimeString("en-US",{hour12:!1,timeStyle:"short"}),{depositMethod:i,settleMethod:o}=t,{asset:l}=i,{asset:d}=o,c=(0,j.Zd)(t.deposits),m=!!t.expiresAtISO&&new Date(t.expiresAtISO)<new Date;return(0,n.jsxs)(M.i.Row,{className:"block cursor-pointer transition md:grid md:grid-cols-[13rem_minmax(0,3fr)_minmax(0,3fr)_10rem_2rem]",hoverable:!0,onClick:s,role:"link",tabIndex:0,onKeyUp:e=>"Enter"===e.key&&s(),"data-sentry-element":"unknown","data-sentry-component":"TableRow","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[(0,n.jsxs)(M.i.Cell,{className:"mb-4 flex w-full justify-between items-center pr-0 md:mb-0 md:inline-flex md:pr-4 ","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-row gap-2 text-left",children:[(0,n.jsxs)("span",{children:[r.getFullYear(),"/",(r.getMonth()+1).toString().padStart(2,"0"),"/",r.getDate().toString().padStart(2,"0")]}),(0,n.jsx)("span",{children:a})]}),(0,n.jsx)("div",{className:"w-min md:hidden",children:(0,n.jsx)(B.X,{status:K(c,m),"data-sentry-element":"OrderStatusWithIcon","data-sentry-source-file":"ShiftsHistoryTable.tsx"})})]}),(0,n.jsxs)(M.i.Cell,{className:"inline-flex max-w-[50%] items-center gap-3 py-1 md:max-w-none","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[i&&(0,n.jsx)(_.O,{token:{asset:"".concat(l," Icon"),network:"".concat(null==i?void 0:i.network," Icon")},tokenImage:(0,O.HN)(i),networkImage:(0,G.o)(i),size:"small"}),(0,n.jsxs)("span",{className:"max-w-min flex-1 overflow-hidden text-ellipsis whitespace-nowrap pl-1",children:[(null==c?void 0:c.depositAmount)&&(0,U.xD)(null==c?void 0:c.depositAmount)," ",l]}),(0,n.jsx)(Z.Z,{className:"dark:text-flashbang-white text-new-black w-4 flex-shrink-0 md:hidden","data-sentry-element":"ArrowRight","data-sentry-source-file":"ShiftsHistoryTable.tsx"})]}),(0,n.jsxs)(M.i.Cell,{className:"inline-flex max-w-[50%] items-center gap-3 py-1 md:max-w-none","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[o&&(0,n.jsx)(_.O,{token:{asset:"".concat(d," Icon"),network:"".concat(null==o?void 0:o.network," Icon")},tokenImage:(0,O.HN)(o),networkImage:(0,G.o)(o),size:"small"}),(0,n.jsxs)("span",{className:"max-w-min flex-1 overflow-hidden text-ellipsis whitespace-nowrap pl-1",children:[(null==c?void 0:c.settleAmount)&&(0,U.xD)(c.settleAmount)," ",d]})]}),(0,n.jsx)(M.i.Cell,{className:"hidden md:inline-flex items-center","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:(0,n.jsx)(B.X,{status:K(c,m),"data-sentry-element":"OrderStatusWithIcon","data-sentry-source-file":"ShiftsHistoryTable.tsx"})}),(0,n.jsx)(M.i.Cell,{className:"hidden pr-0 md:inline-flex md:justify-end items-center","data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:(0,n.jsx)(R,{className:"dark:text-flashbang-white text-new-black float-right h-5","data-sentry-element":"AngleRight","data-sentry-source-file":"ShiftsHistoryTable.tsx"})})]})},Y=()=>{var e;let{shifts:t,isLoading:s,error:r}=A(),i=(0,D.t)(),o=(0,z.Z)(),{restoreLedgerOrderFromId:l}=(0,F.c5)(),d=(0,p.useRouter)(),m=null===(e=c().get())||void 0===e?void 0:e[a.W0];if(!i)return null;if(!m)return(0,n.jsxs)(W.Z,{type:a.GO.NK.Info,className:"md:w-3/4 mt-6 md:mt-10",children:["You need an account to review your shift history. Visit the"," ",(0,n.jsx)("a",{className:"dark:text-pixel-blue",href:S.XA.ACCOUNT,children:"account page"})," ","to create one."]});if(r)return(0,n.jsx)(W.Z,{type:a.GO.NK.Danger,className:"w-fit mt-6 md:mt-10",children:r.message});if(!s&&!t.length)return(0,n.jsx)("p",{className:"mb-0 mt-8 font-light leading-[1.5] sm:mt-16",children:"No history was found. Come back after you have made some shifts, or change your date range."});let f=(e,t)=>{let{id:s,depositMethod:r,settleMethod:n}=e;if(o){l({orderId:s,depositMethodId:r.id,settleMethodId:n.id}).catch(e=>{(0,E.CF)({text:(0,O.Ii)(e.message),type:"error"})});return}if(null==t?void 0:t.metaKey){let e=window.open("/orders/".concat(s),"_blank");null==e||e.focus();return}d.push("/orders/".concat(s))};return s?(0,n.jsxs)(M.i,{children:[(0,n.jsx)(L,{}),(0,n.jsx)(M.i.Body,{children:Array(6).fill(0).map((e,t)=>(0,n.jsxs)(M.i.Row,{children:[(0,n.jsx)(M.i.Cell,{width:"20%",children:(0,n.jsx)(C.O,{className:"h-8 w-full rounded-md"})}),(0,n.jsx)(M.i.Cell,{width:"25%",children:(0,n.jsx)(C.O,{className:"h-8 w-full rounded-md"})}),(0,n.jsx)(M.i.Cell,{width:"30%",children:(0,n.jsx)(C.O,{className:"h-8 w-full rounded-md"})}),(0,n.jsx)(M.i.Cell,{width:"25%",children:(0,n.jsx)(C.O,{className:"h-8 w-full rounded-md"})})]},"treasury-table-row-".concat(t)))})]}):(0,n.jsxs)(M.i,{"data-sentry-element":"Table","data-sentry-component":"ShiftsHistoryTable","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:[(0,n.jsx)(L,{"data-sentry-element":"TableHead","data-sentry-source-file":"ShiftsHistoryTable.tsx"}),(0,n.jsx)(M.i.Body,{"data-sentry-element":"unknown","data-sentry-source-file":"ShiftsHistoryTable.tsx",children:null==t?void 0:t.map(e=>(0,n.jsx)(X,{order:e,onClick:()=>f(e)},e.id))})]})},q=[{id:"depositMethodId",title:"Deposit Method"},{id:"settleMethodId",title:"Settle Method"},{id:"status",title:"Status"},{id:"createdAtISO",title:"Creation Date"},{id:"expiresAtISO",title:"Expiry Date"},{id:"depositAmount",title:"Deposit Amount"},{id:"settleAmount",title:"Settle Amount"},{id:"settleAmountUsd",title:"Settle Amount (USD)"},{id:"orderId",title:"Order ID"}],J=()=>{var e;let{shifts:t,pageSize:s,currentPage:r,goToPage:d,totalCount:u,selectedDateRange:h,updateSelectedDateRange:x,refetchShiftHistory:y,getFormattedShiftsForExport:p}=A(),w=null===(e=c().get())||void 0===e?void 0:e[a.W0],g=t&&t.length>0,S=(0,D.t)(),{id:b}=(0,T.k)(),j=async()=>{var e;if(!h.from||!h.to||!g)return;let t="sideshift-orders-".concat(h.from.toISOString(),"-").concat(null===(e=h.to)||void 0===e?void 0:e.toISOString());try{let e=await p();(0,N.Di)(t,q,e)}catch(e){console.error("Failed to export shifts:",e)}};return(0,m.useEffect)(()=>{S&&b&&y()},[S,b]),(0,n.jsxs)("div",{className:"mx-auto flex w-full max-w-5xl flex-col items-center justify-center gap-8","data-sentry-component":"ShiftsHistory","data-sentry-source-file":"ShiftsHistory.tsx",children:[(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"dark:border-darker-gray border-smoke flex flex-col gap-4 border-b py-4 sm:flex-row sm:items-center sm:justify-between",children:[(0,n.jsx)("h2",{className:"font-text dark:text-smoke text-new-black text-left text-lg uppercase",children:"Your Shifts"}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row",children:[(0,n.jsx)(o.T,{selected:h,setSelected:x,mode:"range",alignment:"right","data-sentry-element":"DateSelector","data-sentry-source-file":"ShiftsHistory.tsx"}),(0,n.jsxs)(i.z,{role:"button",variant:"secondary",buttonSize:"small",className:"border-darker-gray min-w-[unset] max-w-[12.5rem] rounded-md border-[1px] py-[1.65rem]",onClick:j,disabled:!g||!h.from||!h.to||!w,"data-sentry-element":"Button","data-sentry-source-file":"ShiftsHistory.tsx",children:[(0,n.jsx)(f.Z,{className:"text-new-black dark:text-flashbang-white h-6 sm:mr-2","data-sentry-element":"CsvIcon","data-sentry-source-file":"ShiftsHistory.tsx"}),(0,n.jsx)("span",{className:"h-6",children:"Export as Csv"})]})]})]}),(0,n.jsx)(Y,{"data-sentry-element":"ShiftsHistoryTable","data-sentry-source-file":"ShiftsHistory.tsx"})]}),(0,n.jsx)(l.t,{pageSize:s,currentPage:r,setCurrentPage:d,totalCount:u||0,"data-sentry-element":"Pagination","data-sentry-source-file":"ShiftsHistory.tsx"})]})},V=e=>{let{initialShiftsData:t,shouldUseSearchParams:s}=e;return(0,n.jsx)(H,{shouldUseSearchParams:s,initialShiftsData:t,"data-sentry-element":"ShiftsHistoryProvider","data-sentry-component":"ShiftsHistoryWithProvider","data-sentry-source-file":"ShiftsHistory.tsx",children:(0,n.jsx)(J,{"data-sentry-element":"ShiftsHistory","data-sentry-source-file":"ShiftsHistory.tsx"})})}}}]);