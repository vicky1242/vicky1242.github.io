!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="051b5c92-df98-48d1-b113-b4cda3c77198",e._sentryDebugIdIdentifier="sentry-dbid-051b5c92-df98-48d1-b113-b4cda3c77198")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1219],{49166:function(e,t,r){r.d(t,{S:function(){return h},d:function(){return g}});var n=r(82323),a=r(32099),o=r(37579),i=r(97458),s=r(34838),u=r(97269),c=r(52983),l=r(10123),d=r(47331),f=r(35980),p=r(22288),y=r(32019),_=r(56331);let m=()=>{let e=new s.DV;return e.connect(),new s.rX(e)},h=(0,c.createContext)({loading:!0,SDK:m(),switchSelectedAccounts:()=>{},restoreLedgerOrderFromId:()=>Promise.resolve(),ledgerOrderInProgress:p._U}),g=e=>{let{children:t}=e,[r,s]=(0,c.useState)(),[g,b]=(0,c.useState)(),[w,v]=(0,c.useState)(),[I,x]=(0,c.useState)(),[k,S]=(0,c.useState)(),[E,M]=(0,c.useState)(null),{data:O}=(0,l.Z)(),D=(0,y.aD)(),{ledgerOrderInProgress:F}=D,N=(0,o._)(D,["ledgerOrderInProgress"]);(0,c.useEffect)(()=>{E||M(m())},[]);let A=(0,c.useMemo)(()=>Object.fromEntries(Object.entries((null==O?void 0:O.depositMethods)||{}).map(e=>{let[t,r]=e;return[(0,_.F6)(r),t]})),[O]),L=e=>{let{currency:t,spendableBalance:n}=e;if(!r)return null;let a=r.find(e=>e.id===t);if(!a)return null;let{decimals:o}=a;return n.multipliedBy((0,u.Z)("10").exponentiatedBy(-o)).toString()||"0"},B=async()=>{if(F.depositAccount){x(F.depositAccount);return}if(!r||k||I||!E)return;let e=null==r?void 0:r.map(e=>e.id),[t]=await E.account.list({currencyIds:e});x((0,a._)((0,n._)({},t),{balance:L(t),sideshiftId:A[t.currency]}))},U=async()=>{if(F.settleAccount){S(F.settleAccount);return}if(!w||k||!E)return;let e=null==w?void 0:w.map(e=>e.id),[t]=await E.account.list({currencyIds:e});S((0,a._)((0,n._)({},t),{balance:L(t),sideshiftId:A[t.currency]}))},C=async()=>{if(!O||!E)return;let e=Object.values((0,d.D9)(O.depositMethods,e=>{let[,t]=e;return!1!==t.enabled&&p.Gp.includes(t.network)})).map(_.F6);s(await E.currency.list({currencyIds:e}))},P=()=>{if(!O||!k||!r)return;let e=O.settleMethods[A[k.currency]];if(!e)return;let t=Object.values((0,f.U)({depositMethods:O.depositMethods,isEmbedded:!0,isFixed:!0,isSettleMethodFixedOnly:!!e.fixedOnly,isSettleMethodVariableOnly:!!e.variableOnly,allowedMethodsIds:null})).map(_.F6);b(r.filter(e=>t.includes(e.id)))},T=()=>{if(!O||!I||!r)return;let e=O.settleMethods[A[I.currency]];if(!e)return;let t=Object.values((0,f.r)({settleMethods:O.settleMethods,isDepositMethodFixedOnly:!!e.fixedOnly,isDepositMethodVariableOnly:!!e.variableOnly,isXaiBalanceDeposit:!1,allowedMethodsIds:null})).map(_.F6);v(r.filter(e=>t.includes(e.id)))};(0,c.useEffect)(()=>{P()},[k]),(0,c.useEffect)(()=>{T()},[I]);let j=async()=>{if(!E)return;let e=await E.account.request({currencyIds:null==g?void 0:g.map(e=>e.id)});x((0,a._)((0,n._)({},e),{balance:L(e),sideshiftId:A[e.currency]}))},W=async()=>{if(!E)return;let e=await E.account.request({currencyIds:null==w?void 0:w.map(e=>e.id)});S((0,a._)((0,n._)({},e),{balance:L(e),sideshiftId:A[e.currency]}))},H=()=>{if(!(null==k?void 0:k.id)||!(null==I?void 0:I.id))return;let e=(0,n._)({},I);x(k),S(e)},V=async e=>{let{orderId:t,depositMethodId:r,settleMethodId:o}=e,i=null==O?void 0:O.depositMethods[r],s=null==O?void 0:O.settleMethods[o];if(!i||!s)throw Error("Invalid order");if(!E)throw Error("No Ledger Client");let u=(0,_.F6)(i),c=(0,_.F6)(s);if(!u||!c)throw Error("Deposit method not supported");let[l]=await E.account.list({currencyIds:[u]}),[d]=await E.account.list({currencyIds:[c]});if(!l||!d)throw Error("Error communicating with Ledger account");x((0,a._)((0,n._)({},l),{balance:L(l),sideshiftId:A[l.currency]})),S((0,a._)((0,n._)({},d),{balance:L(d),sideshiftId:A[d.currency]})),N.setLedgerOrder(t,(0,a._)((0,n._)({},l),{balance:L(l),sideshiftId:A[l.currency]}),(0,a._)((0,n._)({},d),{balance:L(d),sideshiftId:A[d.currency]}))};(0,c.useEffect)(()=>{r||C().catch(e=>console.log(e))},[O]),(0,c.useEffect)(()=>{r&&!I&&B().catch(e=>console.log(e))},[r,F]),(0,c.useEffect)(()=>{w&&!k&&U().catch(e=>console.log(e))},[w]);let q=(0,c.useMemo)(()=>(0,n._)({mutuallySupportedCurrencies:r,selectedDepositAccount:I,selectedSettleAccount:k,selectDepositAccount:j,selectSettleAccount:W,loading:!I||!k&&!F.orderId,SDK:E,ledgerOrderInProgress:F,switchSelectedAccounts:H,restoreLedgerOrderFromId:V},N),[I,k,r,g,F.orderId,E,V]);return(0,i.jsx)(h.Provider,{value:q,"data-sentry-element":"unknown","data-sentry-component":"LedgerProvider","data-sentry-source-file":"Ledger.context.tsx",children:t})}},32019:function(e,t,r){r.d(t,{$N:function(){return _},aD:function(){return m},c5:function(){return p}});var n=r(21142),a=r(73187),o=r(62795),i=r.n(o),s=r(52983),u=r(2046),c=r(11681),l=r(22288),d=r(49166),f=r(56331);let p=()=>(0,s.useContext)(d.S),y=()=>{let[e]=(0,n.t)(c.Dp);return e},_=()=>{let{selectedDepositAccount:e,selectedSettleAccount:t,SDK:r,mutuallySupportedCurrencies:n}=p(),o=y(),[c,d]=(0,s.useState)(!1),{order:_}=(0,u.A)(),m=async(t,n)=>{if(!e||!r)return null;let a=(await r.currency.list({currencyIds:[e.currency]}))[0];if(!a)return null;let o=(0,f.VI)(a);if(!o)return null;let i=(0,f.$T)(a),{decimals:s}=a,{address:u,memo:c}=n;return o({amount:t,recipient:u,decimals:s,memo:c,isTokenTransaction:i})};return{executeSwap:async(s,u,c)=>{var p,y;if(!e||!t||!_||!r)return{txHash:null,error:Error("Missing account")};let[h]=await r.currency.list({currencyIds:[e.currency]}),[g]=await r.currency.list({currencyIds:[t.currency]}),b=await r.exchange.start("SWAP"),w=await m(s,c);if(!h||!g||!b||!w||!n)return{txHash:null,error:Error("Failed to construct transaction")};let v=(0,f.$T)(g),I=null===(p=v?null==n?void 0:n.find(e=>e.id===g.parent):g)||void 0===p?void 0:p.ticker;if(!I)return{txHash:null,error:Error("Failed to construct transaction")};let x={amountToProvider:(0,a.n)(s).shiftedBy(h.decimals).toString(),amountToWallet:(0,a.n)(u).shiftedBy(g.decimals).toString(),currencyFrom:h.ticker,currencyTo:I,deviceTransactionId:b,payinAddress:c.address,payinExtraId:c.memo,payoutAddress:t.address,payoutExtraId:"",refundAddress:e.address,refundExtraId:""},{data:k,error:S}=await o({variables:{input:x}});if(S)return{txHash:null,error:S};if(!k)return{txHash:null,error:Error("Failed to sign transaction")};let{payload:E,signature:M}=k.signLedgerTransaction,O=parseFloat(null!==(y=_.settleRate)&&void 0!==y?y:"NaN"),D=await r.exchange.completeSwap({binaryPayload:i().toBuffer(E),feeStrategy:"MEDIUM",fromAccountId:null==e?void 0:e.id,provider:l.sW,rate:O,signature:i().toBuffer(M),swapId:b,toAccountId:null==t?void 0:t.id,transaction:w,tokenCurrency:v?g.ticker:void 0});return D?(d(!0),{txHash:D,error:null}):{txHash:null,error:Error("Error sending transaction")}},hasSentFromLedger:c}},m=()=>{let{SDK:e}=p(),[t,r]=(0,s.useState)(l._U),n=async()=>{if(!e)return;let t=await (0,f.Yv)(e.storage);r(null!=t?t:l._U)},a=()=>{e&&e.storage.set(l.Nn,JSON.stringify(l._U))};return(0,s.useEffect)(()=>{n()},[]),{ledgerOrderInProgress:t,setLedgerOrder:(t,n,a)=>{e&&(e.storage.set(l.Nn,JSON.stringify({orderId:t,depositAccount:n,settleAccount:a})),r({orderId:t,depositAccount:n,settleAccount:a}))},resetLedgerOrder:()=>{a(),r(l._U)},clearStoredLedgerOrder:a}}},22288:function(e,t,r){r.d(t,{Gp:function(){return i},M8:function(){return u},Nn:function(){return n},Wk:function(){return s},_U:function(){return a},sW:function(){return o}});let n="ledger-order-in-progress",a={orderId:null,depositAccount:null,settleAccount:null},o="ssaitest",i=["bitcoin","bitcoincash","bsc","dash","doge","ethereum","litecoin","polygon","ripple","solana"],s=["Interrupted by user","User refused"],u={"Incorrect command data":"Deposit method is not supported","Failed to fetch":"Network error, please check your connection and try again","unexpected fee: <null>, after retry with a new blockhash":"Failed to estimate network fee, please try again later"}},56331:function(e,t,r){r.d(t,{$T:function(){return b},AJ:function(){return I},F6:function(){return _},VI:function(){return w},Yv:function(){return v}});var n=r(97269),a=r(48806),o=r(6148),i=r(22288),s=r(15313).Buffer;let u=(e,t)=>{let r=(0,a.R)({abi:o.Wo,functionName:"transfer",args:[e,BigInt(t.toString())]});return s.from(r.slice(2),"hex")},c={usdc:"usd__coin",imx:"immutable_x",ldo:"lido_dao_token",xai:"sideshift_token",tusd:"trueusd",grt:"graph_token",woo:"wootrade_network",qnt:"quant","1inch":"1inch_token",mana:"decentraland_mana",syn:"synapse_protocol",ton:"wrapped_ton_coin",gns:"gains_network",usdt:"usd_tether__erc20_",shib:"shiba_inu",comp:"compound",uni:"uniswap",yfi:"yearn_finance",wbtc:"wrapped_bitcoin",lrc:"loopringcoin_v2",ens:"ethereum_name_service",snx:"synthetix_network_token",link:"chainlink_token",weth:"wrapped_ether",pax:"paxos_standard__pax_",looks:"looksrare_token",paxg:"paxos_gold",chz:"chiliz",spank:"spankchain",ftt:"ftx_token",axs:"axie_infinity_shard",srm:"project_serum",dai:"dai_stablecoin_v2_0",slp:"smooth_love_potion",ape:"apecoin"},l={usdc:"usd_coin_(pos)",usdt:"(pos)_tether_usd"},d={usdc:"binance-peg_usd_coin",busd:"binance-peg_busd_token",usdt:"binance-peg_bsc-usd"},f=(e,t)=>"polygon"===t?l[e]||f(e):"bsc"===t?d[e]||f(e):c[e]||e,p=e=>{switch(e){case"avax":return"avalanche_c_chain";case"bitcoincash":return"bitcoin_cash";case"etc":return"ethereum_classic";case"doge":return"dogecoin";case"via":return"viacoin";default:return e}},y=(e,t)=>{switch(t){case"avax":return"avalanche_c_chain";case"bsc":return"bep20";default:return e}},_=e=>{let{asset:t,network:r,tokenAddress:n,transport:a}=e,o=null===n||"NULL"===n,i=p(r);if(o)return i;let s=y(a,r),u=["tron"].includes(r)?n:f(t.toLowerCase(),r);return"".concat(i,"/").concat(s,"/").concat(u).toLowerCase()},m=(e,t)=>(0,n.O)(e).multipliedBy((0,n.O)("10").exponentiatedBy(t)),h={algorand:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),family:"algorand",mode:"send",recipient:n}},bitcoin:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,family:"bitcoin"}},cosmos:e=>{let{amount:t,decimals:r,recipient:n,memo:a}=e;return{amount:m(t,r),family:"cosmos",memo:a,mode:"send",recipient:n}},crypto_org:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,mode:"send",family:"crypto_org"}},ethereum:e=>{let{amount:t,decimals:r,recipient:n,isTokenTransaction:a}=e;return{amount:m(t,r),recipient:n,family:"ethereum",data:a?u(n,m(t,r)):void 0}},polkadot:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,mode:"send",family:"polkadot"}},ripple:e=>{let{amount:t,decimals:r,recipient:n,memo:a}=e;return{amount:m(t,r),recipient:n,tag:parseInt(null!=a?a:"NaN"),family:"ripple"}},stellar:e=>{let{amount:t,decimals:r,recipient:n,memo:a}=e;return{amount:m(t,r),recipient:n,family:"stellar",memoValue:a,memoType:"MEMO_ID"}},tron:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,mode:"send",family:"tron"}},near:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,mode:"send",family:"near"}},solana:e=>{let{amount:t,decimals:r,recipient:n}=e;return{amount:m(t,r),recipient:n,family:"solana",model:{kind:"transfer",uiState:{}}}}},g=e=>["bsc","polygon"].includes(e)?"ethereum":e,b=e=>"CryptoCurrency"!==e.type,w=e=>b(e)?h[g(e.parent)]||null:h[g(e.family)]||null,v=async e=>{let t=await e.get(i.Nn);return t?JSON.parse(t):i._U},I=e=>!e||i.Wk.includes(e)?null:i.M8[e]||e},87066:function(e,t,r){r.d(t,{KD:function(){return a},Zd:function(){return n},a8:function(){return i}});let n=e=>e.find(e=>e.depositAmount&&e.settleRate&&e.settleAmount)||e[0],a=e=>"tron"===e,o=e=>{let t=Math.ceil(e/60);return 1===t?"~1 minute":"~".concat(t," minutes")},i=(e,t)=>e.averageDepositSeconds&&t.averageSettleSeconds?o(parseFloat(e.averageDepositSeconds)+parseFloat(t.averageSettleSeconds)):null}}]);